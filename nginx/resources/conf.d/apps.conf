upstream appsapca.leon-grosse.fr {
    server tomcat:8080;
}

upstream appsacau.leon-grosse.fr {
    server tomcat:8080;
}

upstream appsasgr.leon-grosse.fr {
    server tomcat:8080;
}

upstream appsagpe.leon-grosse.fr {
    server tomcat:8080;
}

upstream appsacdc.leon-grosse.fr {
    server tomcat:8080;
}

upstream appsarlg.leon-grosse.fr {
    server tomcat:8080;
}

upstream appssirh.leon-grosse.fr {
    server tomcat:8080;
}


server {
    listen 80;
    listen [::]:80;
    
    listen 443 ssl;
    ssl_certificate /etc/nginx/ssl/xxx.leon-grosse.fr.cer;
    ssl_certificate_key /etc/nginx/ssl/xxx.leon-grosse.fr.key;

    server_name srv-appspe.leon-grosse.fr;

    access_log /etc/nginx/log/apps-access.log;
    error_log /etc/nginx/log/apps-error.log;

    add_header SAMACCOUNTNAME $http_samaccountname;

    location /apca/ {
        proxy_http_version 1.1;
        proxy_set_header Connection "";
        proxy_set_header SAMACCOUNTNAME $http_samaccountname;
        proxy_pass http://appsapca.leon-grosse.fr/;
    }

    location /acau/ {
        proxy_http_version 1.1;
        proxy_set_header Connection "";
        proxy_set_header SAMACCOUNTNAME $http_samaccountname;
        proxy_pass http://appsacau.leon-grosse.fr/;
    }

    location /asgr/ {
        proxy_http_version 1.1;
        proxy_set_header Connection "";
        proxy_set_header SAMACCOUNTNAME $http_samaccountname;
        proxy_pass http://appsasgr.leon-grosse.fr/;
    }

    location /agpe/ {
        proxy_http_version 1.1;
        proxy_set_header Connection "";
        proxy_set_header SAMACCOUNTNAME $http_samaccountname;
        proxy_pass http://appsagpe.leon-grosse.fr/;
    }

    location /acdc/ {
        proxy_http_version 1.1;
        proxy_set_header Connection "";
        proxy_set_header SAMACCOUNTNAME $http_samaccountname;
        proxy_pass http://appsacdc.leon-grosse.fr/;
    }

    location /arlg/ {
        proxy_http_version 1.1;
        proxy_set_header Connection "";
        proxy_set_header SAMACCOUNTNAME $http_samaccountname;
        proxy_pass http://appsarlg.leon-grosse.fr/;
    }

    location /sirh/ {
        proxy_http_version 1.1;
        proxy_set_header Connection "";
        proxy_set_header SAMACCOUNTNAME $http_samaccountname;
        proxy_pass http://appssirh.leon-grosse.fr/;
    }
}
