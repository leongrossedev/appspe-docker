upstream apps-oid.leon-grosse.fr_ref {
    server apis-ref:8082;
}

upstream apps-oid.leon-grosse.fr_pca {
    server apis-ref:8086;
}

upstream apps-oid.leon-grosse.fr_google {
    server apis-ref:8084;
}

upstream apps-oid.leon-grosse.fr_ad {
    server apis-ref:8083;
}

upstream apps-oid.leon-grosse.fr_lol {
    server apis-ref:8085;
}


server {
    listen 80;
    listen [::]:80;
    
    listen 443 ssl;
    ssl_certificate /etc/nginx/ssl/xxx.leon-grosse.fr.cer;
    ssl_certificate_key /etc/nginx/ssl/xxx.leon-grosse.fr.key;

    server_name apps-oid.leon-grosse.fr;

    access_log /etc/nginx/log/apps-oid-access.log;
    error_log /etc/nginx/log/apps-oid--error.log;

    location /referentiel-api-rest/ {
        proxy_http_version 1.1;
        proxy_set_header Connection "";
        proxy_pass http://apps-oid.leon-grosse.fr_ref/referentiel-api-rest/;
    }
    
    location /previsionsca-api-rest/ {
        proxy_http_version 1.1;
        proxy_set_header Connection "";
        proxy_pass http://apps-oid.leon-grosse.fr_pca/previsionsca-api-rest/;
    }

    location /google-api-rest/ {
        proxy_http_version 1.1;
        proxy_set_header Connection "";
        proxy_pass http://apps-oid.leon-grosse.fr_google/google-api-rest/;
    }

    location /signin-api-rest/ {
        proxy_http_version 1.1;
        proxy_set_header Connection "";
        proxy_pass http://apps-oid.leon-grosse.fr_ad/signin-api-rest/;
    }

    location /leonline-api-rest/ {
        proxy_http_version 1.1;
        proxy_set_header Connection "";
        proxy_pass http://apps-oid.leon-grosse.fr_lol/leonline-api-rest/;
    }
}
